<!--
  #%L
  Signs at work
  %%
  Copyright (C) 2016 Orange
  %%
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as
  published by the Free Software Foundation, either version 2 of the
  License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public
  License along with this program.  If not, see
  <http://www.gnu.org/licenses/gpl-2.0.html>.
  #L%
  -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <th:block th:include="fragments/header-head :: head"></th:block>
    <script type="text/javascript" src="../public/js/RecordRTC.js" th:src="@{/js/RecordRTC.js}"></script>
</head>

<header role="banner" th:replace="fragments/header-profile-from-community :: header">&nbsp;</header>


    <body class="container-fluid">
      <div th:replace="fragments/modal-input-name :: div"/>
      <div th:replace="fragments/modal-input-entity-name :: div"/>
      <div th:replace="fragments/modal-input-job-name :: div"/>
      <div th:replace="fragments/modal-input-description-job :: div"/>
      <div th:replace="fragments/modal-input-email :: div"/>
      <div class="row">

       <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12">
          <aside class="sidebar">
            <ul th:if="${isConnectedUser}" class="nav nav-list primary left-menu">
              <li class="aside_bckg_li">
                <div th:if="${user.namePicture != null}" style="display: inline;">
                  <h2 style="display: inline;vertical-align: top;" th:text="#{name_LSF}"></h2>
                  <a data-target="#play_video" data-toggle="modal" href="#" th:with='cleaned=${#strings.replace(user.name(), "&apos;", "\&apos;")}' th:onclick="'javascript:displayVideo(\'' + ${user.nameVideo} +'\',\''+  ${cleaned} + '\')'" style="margin-left: 35px;">
                    <img th:src="${user.namePicture}" th:attr="alt=#{name_LSF}" style="margin-bottom: 10px;"/>
                  </a>
                  <a data-target="#add_video_file_recording" data-toggle="modal" href="#" th:attr="aria-label=#{name_video_record}">
                    <div id="nameVideo-record" class="pull-right picto-record" style="margin-top: 55px; display: none;"></div>
                  </a>
                </div>
                <div th:if="${user.namePicture == null}" style="display: inline;">
                  <h2 style="display: inline;" th:text="#{name_LSF}"></h2>
                  <h2 style="display: inline; font-style: italic; color:lightgrey;" th:text="#{to_complete}"></h2>
                  <a data-target="#add_video_file_recording" data-toggle="modal" href="#" th:attr="aria-label=#{name_video_record}">
                    <div id="nameVideo-record" class="pull-right picto-record" style="margin-top: 2px; display: none;"></div>
                  </a>
                </div>
              </li>
              <li class="aside_bckg_li">
                <a id="changeName" data-target="#add_name" data-toggle="modal" href="#" style="pointer-events: none;">
                  <div>
                    <h2 style="display: inline;" th:text="#{name}"></h2>
                    <h2 style="display: inline;margin-left: 34px; color: #4866F7;" th:text="${user.name()}"></h2>
                    <div id="name-pen" class="pull-right picto-pen" style="display: none;"></div>
                  </div>
                </a>
              </li>
              <li class="aside_bckg_li">
                <a id="changeUserName" data-target="#add_email" data-toggle="modal" href="#" style="pointer-events: none">
                  <div>
                    <h2 style="display: inline;" th:text="#{email}"></h2>
                    <h2 style="display: inline;margin-left: 25px; color: #4866F7;" th:text="${user.username}"></h2>
                    <div id="user_name-pen" class="pull-right picto-pen" style="display: none;"></div>
                  </div>
                </a>
              </li>
              <li class="aside_bckg_li" style="border-bottom: 3px solid;">
                <a id="changeEntity" data-target="#add_entity_name" data-toggle="modal" href="#" style="pointer-events: none">
                  <div th:if="${user.entity != null}">
                    <h2 style="display: inline;" th:text="#{entity}"></h2>
                    <h2 style="display: inline;margin-left: 20px; color: #4866F7;" th:text="${user.entity}"></h2>
                    <div id="entity-pen" class="pull-right picto-pen" style="display: none;"></div>
                  </div>
                  <div th:if="${user.entity == null}">
                    <h2 style="display: inline;" th:text="#{entity}"></h2>
                    <h2 style="display: inline;margin-left: 20px; font-style: italic; color:lightgrey;" th:text="#{to_complete}"></h2>
                    <div id="entity-pen" class="pull-right picto-pen" style="display: none;"></div>
                  </div>
                </a>
              </li>
              <li class="aside_bckg_li">
                <a id="changeJobName" href="/sec/my-job" style="pointer-events: none">
                  <div th:if="${user.job != null}">
                    <h2 style="display: inline;" th:text="#{job}"></h2>
                    <h2 id="jobName" style="display: inline;margin-left: 20px; color: #4866F7;" th:text="${user.job}"></h2>
                    <div id="jobName-pen" class="pull-right picto-pen" style="display: none;"></div>
                  </div>
                  <div th:if="${user.job == null}">
                    <h2 style="display: inline;" th:text="#{job}"></h2>
                    <h2 style="display: inline;margin-left: 20px; font-style: italic; color:lightgrey;" th:text="#{to_complete}"></h2>
                    <div id="jobName-pen" class="pull-right picto-pen" style="display: none;"></div>
                  </div>
                </a>
              </li>
              <li class="aside_bckg_li">
                <div th:if="${user.jobDescriptionPicture != null}" style="display: inline;">
                  <h2 style="display: inline;" th:text="#{description_LSF}"></h2>
                  <a data-target="#play_video" data-toggle="modal" href="#" th:onclick="'javascript:displayVideo(\'' + ${user.jobDescriptionVideo} +'\',\''+  ${user.job} + '\')'" style="margin-left: 35px;">
                    <img th:src="${user.jobDescriptionPicture}"  th:attr="alt=#{description_LSF}" style="margin-bottom: 10px;margin-left: 110px;"/>
                  </a>
                  <a data-target="#add_video_file_recording" data-toggle="modal" href="#" th:attr="aria-label=#{job_video_record}">
                    <div id="jobVideo-record" class="pull-right picto-record" style="margin-top: 55px; display: none;"></div>
                  </a>
                </div>
                <div th:if="${user.jobDescriptionPicture == null}" style="display: inline;">
                  <h2 style="display: inline;" th:text="#{description_LSF}"></h2>
                  <h2 style="display: inline; font-style: italic; color:lightgrey;" th:text="#{to_complete}"></h2>
                  <a data-target="#add_video_file_recording" data-toggle="modal" href="#" th:attr="aria-label=#{job_video_record}">
                    <div id="jobVideo-record" class="pull-right picto-record" style="margin-top: 2px; display: none;"></div>
                  </a>
                </div>
              </li>
              <li class="aside_bckg_li" style="border-bottom: 3px solid #4866F7;">
                <div th:if="${user.jobDescriptionText != null and !#strings.isEmpty(user.jobDescriptionText)}">
                  <h2 style="display: inline;" th:text="#{description_text}"></h2>
                  <a id="changeJobDescriptionText" data-target="#add_description_job" data-toggle="modal" href="#" style="pointer-events: none">
                    <div>
                      <h2 style="display: inline-block; color: #4866F7;width: 90%;" th:text="${user.jobDescriptionText}"></h2>
                      <div id="jobText-pen" class="pull-right picto-pen" style="margin-top: 13px; display: none;"></div>
                    </div>
                  </a>
                </div>
                <div th:if="${user.jobDescriptionText == null or #strings.isEmpty(user.jobDescriptionText)}">
                  <a id="changeJobDescriptionText" data-target="#add_description_job" data-toggle="modal" href="#" style="pointer-events: none">
                    <div>
                      <h2 style="display: inline;" th:text="#{description_text}"></h2>
                      <h2 style="display: inline; font-style: italic; color:lightgrey;" th:text="#{to_complete}"></h2>
                      <div id="jobText-pen" class="pull-right picto-pen" style="display: none;"></div>
                    </div>
                  </a>
                </div>
              </li>
            </ul>
            <ul id="profil" th:unless="${isConnectedUser}" class="nav nav-list primary left-menu">
              <li th:if="${user.namePicture != null}" class="aside_bckg_li">
                <div style="display: inline;">
                  <h2 style="display: inline;vertical-align: top;" th:text="#{name_LSF}"></h2>
                  <a data-target="#play_video" data-toggle="modal" href="#" th:with='cleaned=${#strings.replace(user.name(), "&apos;", "\&apos;")}' th:onclick="'javascript:displayVideo(\'' + ${user.nameVideo} +'\',\''+  ${cleaned} + '\')'" style="margin-left: 35px;">
                    <img th:src="${user.namePicture}" th:attr="alt=#{name_LSF}" style="margin-bottom: 10px;"/>
                  </a>
                </div>
              </li>
              <li class="aside_bckg_li">
                  <div>
                    <h2 style="display: inline;" th:text="#{name}"></h2>
                    <h2 style="display: inline;margin-left: 34px; color: #4866F7;" th:text="${user.name()}"></h2>
                  </div>
              </li>
              <li class="aside_bckg_li" style="border-bottom: 3px solid;">
                  <div th:if="${user.entity != null}">
                    <h2 style="display: inline;" th:text="#{entity}"></h2>
                    <h2 style="display: inline;margin-left: 20px; color: #4866F7;" th:text="${user.entity}"></h2>
                  </div>
                  <div th:if="${user.entity == null}">
                    <h2 style="display: inline;" th:text="#{entity}"></h2>
                  </div>
              </li>
              <li class="aside_bckg_li">
                  <div th:if="${user.job != null}">
                    <h2 style="display: inline;" th:text="#{job}"></h2>
                    <h2 id="jobName" style="display: inline;margin-left: 20px; color: #4866F7;" th:text="${user.job}"></h2>
                  </div>
                  <div th:if="${user.job == null}">
                    <h2 style="display: inline;" th:text="#{job}"></h2>
                  </div>
              </li>
              <li th:if="${user.jobDescriptionPicture != null}"  class="aside_bckg_li">
                <div style="display: inline;">
                  <h2 style="display: inline;" th:text="#{description_LSF}"></h2>
                  <a data-target="#play_video" data-toggle="modal" href="#" th:onclick="'javascript:displayVideo(\'' + ${user.jobDescriptionVideo} +'\',\''+  ${user.job} + '\')'" style="margin-left: 35px;">
                    <img th:src="${user.jobDescriptionPicture}"  th:attr="alt=#{description_LSF}" style="margin-bottom: 10px;margin-left: 110px;"/>
                  </a>
                </div>
              </li>
              <li th:if="${user.jobDescriptionText != null}" class="aside_bckg_li">
                <div>
                  <h2 style="display: inline;" th:text="#{description_text}"></h2>
                    <div>
                      <h2 style="display: inline-block; color: #4866F7;width: 90%;" th:text="${user.jobDescriptionText}"></h2>
                    </div>
                </div>
              </li>
            </ul>
          </aside>
         <div class="text-center title_middle col-md-8 col-xs-12 middle-col ">
         <h2 th:if="${isConnectedUser}" th:text="#{video.createBy_me(${#lists.size(videosView)})}" class="blue"></h2>
          <h2 th:unless="${isConnectedUser}" th:text="#{video.createBy(${user.firstName}, ${#lists.size(videosView)})}" class="blue"></h2>
          <div class="row ">
            <div th:if="${not #lists.isEmpty(videosView)}" id="videos-container" class="row">
              <div th:each="videoView:${videosView}" class="video-view-hidden text-center col-lg-3 col-md-4 col-xs-6 col-sm-4">
                <div class="row">
                  <div class="col-lg-12 col-xs-12">
                    <div th:if="${videoView.videoCreateAfterLastDateDeconnection}" class="tooltip_newSigne"></div>
                    <div th:if="${!videoView.videoCreateAfterLastDateDeconnection}" style="visibility: hidden" class="tooltip_newSigne"></div>
                    <div th:if="${videoView.signBelowToFavorite}" class="tooltip_favorite"></div>
                    <div th:if="${!videoView.signBelowToFavorite}" style="visibility: hidden" class="tooltip_favorite"></div>
                    <div id="labelSigne" class="text_hyphenation">
                      <a th:href="@{/sign/} + ${videoView.signId} + '/' + ${videoView.videoId}" th:text="${videoView.videoName}" type="text/html"/></div>
                    <a th:href="@{/sign/} + ${videoView.signId} + '/' + ${videoView.videoId}" >
                      <div class="container_tooltip_in_image">
                        <div th:if="${videoView.videoHasComment}" class="tooltip_comment"></div>
                        <div th:if="${!videoView.videoHasComment}" style="visibility: hidden" class="tooltip_comment"></div>
                        <div th:if="${videoView.videoHasPositiveRate}" class="tooltip_positif"></div>
                        <div th:if="${!videoView.videoHasPositiveRate}" style="visibility: hidden" class="tooltip_positif"></div>
                        <div th:if="${videoView.videoHasView}" class="tooltip_eye"></div>
                        <div th:if="${!videoView.videoHasView}" style="visibility: hidden" class="tooltip_eye"></div>
                      </div>
                      <img th:attr="data-src=${videoView.pictureUri}, alt=${videoView.videoName}"/>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
       </div>
      </div>

      <div  id="play_video" class="modal" role="dialog">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h2 class="pull-left text_hyphenation" id="videoName"/>
            </div>
            <div class="modal-body text-center">
              <div class="embed-responsive embed-responsive-16by9">
                <iframe class="embed-responsive-item"  id="videoUrl"  frameborder="0" allowfullscreen=""/>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="add_video_file_recording" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <div class="pull-left">
                <div class="lsf_white pull-left"></div>
                <h2 class="pull-right" th:text="#{recording}"></h2>
              </div>
            </div>
            <div  class="container_record text-center">
              <h4 id="label_record" th:text="#{record_name_lsf(${'&laquo;'+user.name()+'&raquo;'})}" style="display: none"></h4>
              <h4 id="label_after_record" th:text="#{after_record_name_lsf(${'&laquo;'+user.name()+'&raquo;'})}" style="display: none"></h4>
              <h4 id="label_record_job_description" th:text="#{record_job_lsf(${'&laquo;'+user.job+'&raquo;'})}" style="display: none"></h4>
              <h4 id="label_after_record_job_description" th:text="#{after_record_job_lsf(${'&laquo;'+user.job+'&raquo;'})}" style="display: none"></h4>
              <div id="container_video" class="col-xs-offset-1 col-xs-10" >
                <div class="spinner spinner_hidden"></div>
                <span id="counter"></span>
                <video id="video"></video>
              </div>

              <div class="btn-group-vertical" role="group">
                <button id="start-recording" class="record" title="Cliquer pour enregistrer"></button>
                <div id="container-button" class="btn-group-vertical" role="group" style="display: none">
                </div>
                <button id="stop-recording" class="stop" title="Arrêter l'enregistrement" disabled="" style="display: none"></button>
              </div>

            </div>
            <form id="uploadRecordedVideoFile" th:action="@{/ws/sec/uploadRecordedVideoFileForName}" method="post">
              <div class="modal-body text-center">
                <span id="errorSpan"  style="visibility: hidden"></span>
              </div>
              <div id="modal-footer_add_video_file_recording" class="modal-footer" style="display: none">
                <div class="retry_recording pull-left"></div>
                <button id="cancel-recording" type="button" data-dismiss="" class="btn btn-secondary" title="Cliquer pour annuler">
                  <span th:text="#{cancel}"></span>
                </button>
                <button id="retry-recording" type="button" class="btn btn-secondary" title="Cliquer pour enregistrer">
                  <span th:text="#{retry}"></span>
                </button>
                <button id="continue" type="submit" class="btn btn-primary" data-dismiss="" disabled="" >
                  <div id="btnChecked"></div><span th:text="#{validate}" ></span>
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div  id="validate_send_mail" class="modal" role="dialog">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <div class="pull-left">
                <div class="mail_white pull-left"></div>
                <h2 class="pull-right" th:text="#{modify_your_email}"/>
              </div>
            </div>
            <div class="modal-body">
              <h4 class="blue" th:text="#{validate_send_mail_for_change_email_body}"></h4>
            </div>
          </div>
        </div>
      </div>
    </body>
<script type="text/javascript" src="../public/js/video-lazy-loading.js" th:src="@{/js/video-lazy-loading.js}"></script>
<script type="text/javascript" src="../public/js/profil.js" th:src="@{/js/profil.js}"></script>
<script >
  $(function () {
    objectFitImages ('img', {watchMQ: true});
  });
</script>
</html>
